# Splunk Props Configuration for POAM Tracker Backend
# Place this file in $SPLUNK_HOME/etc/apps/poam_tracker/local/props.conf

[poam:security:json]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "timestamp":"
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 32
KV_MODE = json
EXTRACT-event_id = "eventId":"(?<event_id>[^"]+)"
EXTRACT-event_type = "eventType":"(?<event_type>[^"]+)"
EXTRACT-user_id = "userId":(?<user_id>\d+)
EXTRACT-user_email = "userEmail":"(?<user_email>[^"]+)"
EXTRACT-source_ip = "ipAddress":"(?<source_ip>[^"]+)"
EXTRACT-correlation_id = "correlationId":"(?<correlation_id>[^"]+)"
EXTRACT-severity = "severity":"(?<severity>[^"]+)"
EXTRACT-classification = "classification":"(?<classification>[^"]+)"

[poam:audit:json]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "timestamp":"
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 32
KV_MODE = json
EXTRACT-audit_id = "auditId":"(?<audit_id>[^"]+)"
EXTRACT-action = "action":"(?<action>[^"]+)"
EXTRACT-resource = "resource":"(?<resource>[^"]+)"
EXTRACT-resource_id = "resourceId":"?(?<resource_id>[^",]+)"?
EXTRACT-user_id = "userId":(?<user_id>\d+)
EXTRACT-user_email = "userEmail":"(?<user_email>[^"]+)"
EXTRACT-source_ip = "ipAddress":"(?<source_ip>[^"]+)"
EXTRACT-correlation_id = "correlationId":"(?<correlation_id>[^"]+)"

[poam:application:json]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "timestamp":"
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 32
KV_MODE = json
EXTRACT-level = "level":"(?<log_level>[^"]+)"
EXTRACT-context = "context":"(?<context>[^"]+)"
EXTRACT-correlation_id = "correlationId":"(?<correlation_id>[^"]+)"
